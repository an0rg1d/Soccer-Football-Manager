{% extends 'base.html.twig' %}

{% block title %}Football Clubs{% endblock %}

{% block body %}
    <main class="flex flex-col lg:flex-row">
        <div class="px-16 pt-12 w-full h-full">
            <h1 class="text-4xl font-bold text-gray-800">Football Clubs Database</h1>
            <p class="text-2xl text-gray-600 mt-4">Explore the world's most prestigious football clubs and their managers</p>

            {% if clubs is defined and clubs|length > 0 %}
                <div class="mt-12 overflow-x-auto shadow-lg rounded-lg border border-gray-200">
                    <table class="min-w-full bg-white">
                        <thead class="bg-gradient-to-r from-green-600 to-green-700 text-white">
                        <tr>
                            <th class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Club</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">League</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Location</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Stadium</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Manager</th>
                            <th class="px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider">Founded</th>
                            <th class="px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider">Market Value</th>
                        </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                        {% for club in clubs %}
                            <tr class="hover:bg-gray-50 transition-colors duration-200 {% if loop.index is odd %}bg-white{% else %}bg-gray-50{% endif %}">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-12 w-12">
                                            <div class="h-12 w-12 rounded-full bg-gradient-to-r from-green-400 to-green-600 flex items-center justify-center text-white font-bold text-sm">
                                                {{ club.name|slice(0, 2)|upper }}
                                            </div>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">{{ club.name }}</div>
                                            <div class="text-xs text-gray-500">#{{ club.id }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex px-3 py-1 text-xs font-semibold rounded-full
                                        {% if 'Premier League' in club.league %}bg-purple-100 text-purple-800
                                        {% elseif 'La Liga' in club.league %}bg-red-100 text-red-800
                                        {% elseif 'Serie A' in club.league %}bg-blue-100 text-blue-800
                                        {% elseif 'Bundesliga' in club.league %}bg-yellow-100 text-yellow-800
                                        {% elseif 'Ligue 1' in club.league %}bg-indigo-100 text-indigo-800
                                        {% elseif 'Eredivisie' in club.league %}bg-orange-100 text-orange-800
                                        {% else %}bg-gray-100 text-gray-800{% endif %}">
                                        {{ club.league }}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <span class="text-sm font-medium text-gray-900">{{ club.city }}</span>
                                        <span class="ml-2 text-xs text-gray-500">{{ club.country }}</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                                            üèüÔ∏è {{ club.stadium }}
                                        </span>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-8 w-8">
                                            <div class="h-8 w-8 rounded-full bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center text-white font-bold text-xs">
                                                {{ club.manager|slice(0, 1)|upper }}
                                            </div>
                                        </div>
                                        <div class="ml-3">
                                            <div class="text-sm font-medium text-gray-900">{{ club.manager }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-center">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                                        {% if club.yearFounded < 1900 %}bg-yellow-100 text-yellow-800
                                        {% elseif club.yearFounded < 1950 %}bg-green-100 text-green-800
                                        {% else %}bg-blue-100 text-blue-800{% endif %}">
                                        üìÖ {{ club.yearFounded }}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-center">
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium
                                        {% if club.marketValue >= 10000000000 %}bg-gradient-to-r from-yellow-400 to-yellow-600 text-white
                                        {% elseif club.marketValue >= 7000000000 %}bg-gradient-to-r from-green-400 to-green-600 text-white
                                        {% elseif club.marketValue >= 5000000000 %}bg-blue-100 text-blue-800
                                        {% else %}bg-gray-100 text-gray-800{% endif %}">
                                        üí∞ ‚Ç¨{{ (club.marketValue / 1000000000)|number_format(1) }}B
                                    </span>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Table Footer with Stats -->
                <div class="mt-4 bg-gray-50 px-6 py-3 rounded-lg border border-gray-200">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600">
                        <div class="text-center">
                            <div class="font-semibold text-gray-900">{{ clubs|length }}</div>
                            <div class="text-xs">Total Clubs</div>
                        </div>
                        <div class="text-center">
                            <div class="font-semibold text-gray-900">
                                {% set totalValue = 0 %}
                                {% for club in clubs %}
                                    {% set totalValue = totalValue + club.marketValue %}
                                {% endfor %}
                                ‚Ç¨{{ (totalValue / 1000000000)|number_format(1) }}B
                            </div>
                            <div class="text-xs">Total Market Value</div>
                        </div>
                        <div class="text-center">
                            <div class="font-semibold text-gray-900">
                                {% set avgYear = 0 %}
                                {% for club in clubs %}
                                    {% set avgYear = avgYear + club.yearFounded %}
                                {% endfor %}
                                {{ (avgYear / clubs|length)|round }}
                            </div>
                            <div class="text-xs">Average Founded Year</div>
                        </div>
                        <div class="text-center">
                            <div class="font-semibold text-gray-900">
                                {% set leagues = [] %}
                                {% for club in clubs %}
                                    {% if club.league not in leagues %}
                                        {% set leagues = leagues|merge([club.league]) %}
                                    {% endif %}
                                {% endfor %}
                                {{ leagues|length }}
                            </div>
                            <div class="text-xs">Different Leagues</div>
                        </div>
                    </div>
                </div>

                <!-- Top Clubs Section -->
                <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Most Valuable Club -->
                    <div class="bg-white p-6 rounded-lg shadow border border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">üí∞ Most Valuable</h3>
                        {% set mostValuable = clubs|sort((a, b) => b.marketValue <=> a.marketValue)|first %}
                        {% if mostValuable %}
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-12 w-12 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-white font-bold">
                                    {{ mostValuable.name|slice(0, 2)|upper }}
                                </div>
                                <div class="ml-3">
                                    <div class="text-sm font-medium text-gray-900">{{ mostValuable.name }}</div>
                                    <div class="text-sm text-gray-500">‚Ç¨{{ (mostValuable.marketValue / 1000000000)|number_format(1) }}B</div>
                                </div>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Oldest Club -->
                    <div class="bg-white p-6 rounded-lg shadow border border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">üèõÔ∏è Oldest Club</h3>
                        {% set oldest = clubs|sort((a, b) => a.yearFounded <=> b.yearFounded)|first %}
                        {% if oldest %}
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-12 w-12 bg-gradient-to-r from-green-400 to-green-600 rounded-full flex items-center justify-center text-white font-bold">
                                    {{ oldest.name|slice(0, 2)|upper }}
                                </div>
                                <div class="ml-3">
                                    <div class="text-sm font-medium text-gray-900">{{ oldest.name }}</div>
                                    <div class="text-sm text-gray-500">Founded {{ oldest.yearFounded }}</div>
                                </div>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Premier League Leader -->
                    <div class="bg-white p-6 rounded-lg shadow border border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-900 mb-3">üëë Premier League Leader</h3>
                        {% set plClubs = clubs|filter(club => 'Premier League' in club.league) %}
                        {% set plLeader = plClubs|sort((a, b) => b.marketValue <=> a.marketValue)|first %}
                        {% if plLeader %}
                            <div class="flex items-center">
                                <div class="flex-shrink-0 h-12 w-12 bg-gradient-to-r from-purple-400 to-purple-600 rounded-full flex items-center justify-center text-white font-bold">
                                    {{ plLeader.name|slice(0, 2)|upper }}
                                </div>
                                <div class="ml-3">
                                    <div class="text-sm font-medium text-gray-900">{{ plLeader.name }}</div>
                                    <div class="text-sm text-gray-500">‚Ç¨{{ (plLeader.marketValue / 1000000000)|number_format(1) }}B</div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>

            {% else %}
                <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-12 text-center mt-12">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H9m0 0H5m0 0h2M7 3h10M9 5h6m-3 4h3m-6 0h3"/>
                    </svg>
                    <h3 class="mt-4 text-lg font-medium text-gray-900">No clubs found</h3>
                    <p class="mt-2 text-gray-500">Get started by adding some clubs to your database.</p>
                </div>
            {% endif %}
        </div>
    </main>
{% endblock %}
